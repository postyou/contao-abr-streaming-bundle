//! videojs-http-source-selector v1.1.7 ~~ https://github.com/FreeTubeApp/videojs-http-source-selector ~~ MIT License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["videojs-http-source-selector"]=t(e.videojs)}(this,function(r){"use strict";var e=r.getComponent("MenuItem"),t=r.getComponent("Component");class a extends e{constructor(e,t){t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleClick(){var e,t,l=this.options_,s=(super.handleClick(),[...this.player_.qualityLevels().levels_]);for([e,t]of s.entries())t.enabled=l.index===s.length||l.index===e}update(){var e=this.player_.qualityLevels().selectedIndex;this.selected(this.options_.index===e)}}t.registerComponent("SourceMenuItem",a);const l=r.getComponent("MenuButton");class s extends l{constructor(e,t){super(e,t);var l=this.player_.qualityLevels();if(t&&t.default)if("low"===t.default)for(var[s,o]of l.entries())o.enabled=0===s;else if("high"===t.default)for(let e=0;e<l.length;e++)l[e].enabled=e===l.length-1;this.player_.qualityLevels().on(["change","addqualitylevel","removequalitylevel"],r.bind(this,this.update))}createEl(){return r.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})}buildCSSClass(){return l.prototype.buildCSSClass.call(this)}update(){return l.prototype.update.call(this)}createItems(){var s=[],o=this.player_.qualityLevels(),r=[];for(let l=o.length-1;0<=l;l--){var i=l===o.selectedIndex;let e=""+l,t=l;var n=o[l];n.height?(e=n.height+"p",t=Number.parseInt(n.height,10)):n.bitrate&&(e=Math.floor(n.bitrate/1e3)+" kbps",t=Number.parseInt(n.bitrate,10)),r.includes(e)||(r.push(e),s.push(new a(this.player_,{label:e,index:l,selected:i,sortValue:t})))}return 1<o.length&&s.push(new a(this.player_,{label:"Auto",index:o.length,selected:!1,sortValue:99999})),s.sort(function(e,t){return t.options_.sortValue-e.options_.sortValue}),s}}const o={};class i extends r.getPlugin("plugin"){constructor(e,t){r.registerComponent("SourceMenuButton",s),r.registerComponent("SourceMenuItem",a);var l=((null==r||null==(l=r.obj)?void 0:l.merge)||r.mergeOptions)(o,t);super(e,l),this.options_=l,this.player_=e,this.on(e,"ready",()=>{this.reset(),this.init()})}init(){this.player_.addClass("vjs-http-source-selector"),this.player_.videojsHTTPSouceSelectorInitialized=!0,"Html5"===this.player_.techName_?this.on(this.player_,"loadedmetadata",()=>{this.metadataLoaded()}):(console.error(this.player_.techName_+" tech is not supported"),this.reset())}reset(){this.player_.removeClass("vjs-http-source-selector"),!0===this.player_.videojsHTTPSouceSelectorInitialized&&(this.player_.controlBar.getChild("SourceMenuButton")||this.player_.controlBar.removeChild("SourceMenuButton",{}),this.player_.videojsHTTPSouceSelectorInitialized=!1)}metadataLoaded(){var e=this.player_.controlBar,t=e.getChild("fullscreenToggle");e.getChild("SourceMenuButton")||(t?e.el().insertBefore(e.addChild("SourceMenuButton").el(),t.el()):e.el().append(e.addChild("SourceMenuButton").el()))}}return(0,r.registerPlugin)("httpSourceSelector",i),i.VERSION="1.1.7",i});
//# sourceMappingURL=videojs-http-source-selector.min.js
